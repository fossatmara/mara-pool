# SRI Pool config
authority_public_key = "9auqWEzQDVyd2oe1JVGFLMLHZtCo2FFqZwtKA5gd9xbuEu7PH72"
authority_secret_key = "mkDLTBBRxdBv998612qipDYoTK3YUrqLe8uWw7gu3iXbSrn2n"
cert_validity_sec = 3600
listen_address = "0.0.0.0:34254"

# Coinbase outputs are specified as descriptors. A full list of descriptors is available at
#     https://github.com/bitcoin/bips/blob/master/bip-0380.mediawiki#appendix-b-index-of-script-expressions
# Although the `musig` descriptor is not yet supported and the legacy `combo` descriptor never
# will be. If you have an address, embed it in a descriptor like `addr(<address here>)`.
coinbase_reward_script = "addr(tb1qa0sm0hxzj0x25rh8gw5xlzwlsfvvyz8u96w3p8)"

# Server Id (number to guarantee unique search space allocation across different Pool servers)
server_id = 1

# Pool signature (string to be included in coinbase tx)
pool_signature = "Stratum V2 SRI Pool"

# Enable this option to set a predefined log file path.
# When enabled, logs will always be written to this file.
# The CLI option --log-file (or -f) will override this setting if provided.
# log_file = "./pool.log"

# How many shares we expect to receive in a minute (determines difficulty targets)
shares_per_minute = 6.0
# How many shares do we want to acknowledge in a batch
share_batch_size = 10

# Protocol Extensions Configuration
# Extensions that the pool supports (will accept if requested by clients)
# Comment/uncomment to enable/disable specific extensions:
supported_extensions = [
    # 0x0002,  # Worker-Specific Hashrate Tracking
]

# Extensions that the pool requires (clients must support these to connect)
# Use with caution - requiring extensions may prevent some clients from connecting
required_extensions = [
    # Example: require Worker-Specific Hashrate Tracking
    # 0x0002,
]

# Persistence Configuration
# Controls how share and block events are persisted
[persistence]
entities = ["shares"]  # What to persist: "shares", "blocks", or both
backend = "composite"  # Backend type: "composite", "metrics", "file", or "noop"

# Composite backend routes - events are sent to all matching routes
# Each route can have a fallback for error recovery
[[persistence.composite.routes]]
name = "metrics"
backend = "metrics"
entities = ["shares"]
fallback = "file_backup"  # Fall back to file if metrics fails

[[persistence.composite.routes]]
name = "file_backup"
backend = "file"
entities = ["shares"]
# No fallback - this is the last resort

# Metrics backend configuration (Prometheus)
[persistence.metrics]
resource_path = "/metrics"  # HTTP endpoint path for Prometheus scraping
port = 9091                 # Port for metrics HTTP server

# File backend configuration (used by composite fallback)
[persistence.file]
file_path = "./pool_shares.log"
channel_size = 10000  # Optional, defaults to 10000

# Hosted Sv2 Template Provider config
[template_provider_type.Sv2Tp]
address = "75.119.150.111:8442"
public_key = "9bwHCYnjhbHm4AS3pWg9MtAH83mzWohoJJJDELYBqZhDNqszDLc"
